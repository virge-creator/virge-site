---
import Layout from '../../layouts/Layout.astro';

const posts = await Astro.glob('./*.md');
const sorted = posts.sort((a, b) => new Date(b.frontmatter.date).getTime() - new Date(a.frontmatter.date).getTime());
const base = import.meta.env.BASE_URL;
---
<Layout title="Blog" description="Insights on AI automation, RAG pipelines, and scaling Dutch tech companies internationally — from the Virge.io team.">
  <div class="page-header">
    <h1>Virge.io <span>Blog</span></h1>
    <p>Insights on AI, automation, and scaling technology for business.</p>
  </div>

  <section>
    <div class="container">
      <div class="blog-grid">
        {sorted.map(post => {
          const slug = post.file.split('/').pop()?.replace('.md', '');
          const readingTime = post.rawContent ? Math.ceil(post.rawContent().split(/\s+/).length / 200) : 5;
          return (
            <a href={`${base}blog/${slug}/`} class="blog-card">
              <div class="blog-meta">
                <time>{new Date(post.frontmatter.date).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</time>
                <span>·</span>
                <span>{readingTime} min read</span>
              </div>
              <h3>{post.frontmatter.title}</h3>
              <p>{post.frontmatter.description}</p>
              <span class="read-more">Read more →</span>
            </a>
          );
        })}
      </div>
    </div>
  </section>
</Layout>
